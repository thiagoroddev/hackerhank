# Weather Observation Station 14 - HackerRank Solution

## üìã Descri√ß√£o do Problema

Consultar o **maior valor** de latitude norte (_LAT_N_) da tabela **STATION** que seja **menor que 137.2345**. Truncar a resposta para **4 casas decimais**.

## üóÉÔ∏è Estrutura da Tabela

**STATION**
| Coluna | Tipo | Descri√ß√£o |
|--------|------|-----------|
| ID | Number | ID √∫nico da esta√ß√£o |
| CITY | VARCHAR2(21) | Nome da cidade |
| STATE | VARCHAR2(2) | C√≥digo do estado |
| LAT_N | Number | Latitude Norte |
| LONG_W | Number | Longitude Oeste |

## ‚úÖ Solu√ß√£o

### Para MySQL

```sql
SELECT TRUNCATE(MAX(LAT_N), 4)
FROM STATION
WHERE LAT_N < 137.2345;
```

### Para PostgreSQL

```sql
SELECT TRUNC(MAX(LAT_N)::numeric, 4)
FROM STATION
WHERE LAT_N < 137.2345;
```

## üìö Explica√ß√£o dos Comandos (Para Iniciantes)

### 1. **MAX(LAT_N)**

```sql
MAX(LAT_N)
```

- `MAX()` √© uma **fun√ß√£o de agrega√ß√£o** que retorna o **maior valor** de uma coluna
- `LAT_N` √© a coluna de latitude norte que queremos analisar
- Sem o `MAX()`, receber√≠amos todas as linhas; com ele, recebemos apenas o maior valor

**Outras fun√ß√µes de agrega√ß√£o comuns:**

- `MIN()` - retorna o menor valor
- `AVG()` - retorna a m√©dia
- `SUM()` - retorna a soma
- `COUNT()` - retorna a quantidade de registros

### 2. **WHERE LAT_N < 137.2345**

```sql
WHERE LAT_N < 137.2345
```

- `WHERE` filtra os dados **antes** de aplicar a fun√ß√£o de agrega√ß√£o
- `LAT_N < 137.2345` seleciona apenas latitudes menores que 137.2345
- O `MAX()` ent√£o encontra o maior valor **entre** esses registros filtrados

### 3. **TRUNCATE / TRUNC (Truncar)**

#### MySQL - TRUNCATE()

```sql
TRUNCATE(MAX(LAT_N), 4)
```

- `TRUNCATE(valor, casas_decimais)` **corta** o n√∫mero para a quantidade especificada de casas decimais
- **N√£o arredonda**, apenas remove os d√≠gitos extras
- Exemplo: `TRUNCATE(123.456789, 4)` = `123.4567`

#### PostgreSQL - TRUNC()

```sql
TRUNC(MAX(LAT_N)::numeric, 4)
```

- `TRUNC(valor, casas_decimais)` funciona de forma similar ao TRUNCATE do MySQL
- `::numeric` converte o valor para tipo num√©rico (necess√°rio no PostgreSQL)
- Exemplo: `TRUNC(123.456789::numeric, 4)` = `123.4567`

### üìä Diferen√ßa entre TRUNCATE e ROUND

| Fun√ß√£o             | Comportamento             | Exemplo                          |
| ------------------ | ------------------------- | -------------------------------- |
| **TRUNCATE/TRUNC** | Corta sem arredondar      | `TRUNCATE(12.5678, 2)` ‚Üí `12.56` |
| **ROUND**          | Arredonda matematicamente | `ROUND(12.5678, 2)` ‚Üí `12.57`    |

```sql
-- Compara√ß√£o
TRUNCATE(137.2344999, 4) ‚Üí 137.2344 (apenas corta)
ROUND(137.2344999, 4)    ‚Üí 137.2345 (arredonda para cima)
```

## üéØ Exemplo Pr√°tico

**Dados de entrada (STATION):**

| ID  | CITY      | STATE | LAT_N    | LONG_W   |
| --- | --------- | ----- | -------- | -------- |
| 1   | Portland  | ME    | 43.6614  | 70.2553  |
| 2   | Nashville | TN    | 36.1446  | 86.7489  |
| 3   | Phoenix   | AZ    | 137.2299 | 112.0740 |
| 4   | Boston    | MA    | 42.3601  | 71.0589  |
| 5   | Tokyo     | JP    | 138.7725 | 139.6917 |
| 6   | Miami     | FL    | 137.2344 | 80.1918  |
| 7   | Seattle   | WA    | 47.6062  | 122.3321 |

**Passo a passo:**

1. **WHERE LAT_N < 137.2345** filtra:
   - Portland: 43.6614 ‚úì
   - Nashville: 36.1446 ‚úì
   - Phoenix: 137.2299 ‚úì
   - Boston: 42.3601 ‚úì
   - Tokyo: 138.7725 ‚úó (maior que 137.2345)
   - Miami: 137.2344 ‚úì
   - Seattle: 47.6062 ‚úì

2. **MAX(LAT_N)** encontra o maior entre os filtrados:
   - Maior valor: **137.2344** (Miami)

3. **TRUNCATE(..., 4)** mant√©m 4 casas decimais:
   - Resultado: **137.2344**

**Resultado esperado:**

```
137.2344
```

## üîç Conceitos Importantes

### Fun√ß√µes de Agrega√ß√£o

S√£o fun√ß√µes que **processam m√∫ltiplas linhas** e retornam **um √∫nico valor**:

```sql
-- Sem agrega√ß√£o: retorna todas as linhas
SELECT LAT_N FROM STATION;
-- Resultado: 43.6614, 36.1446, 137.2299, ...

-- Com agrega√ß√£o: retorna um √∫nico valor
SELECT MAX(LAT_N) FROM STATION;
-- Resultado: 138.7725
```

### Ordem de Execu√ß√£o SQL

```sql
SELECT TRUNCATE(MAX(LAT_N), 4)  -- 3. Aplica fun√ß√£o de formata√ß√£o
FROM STATION                      -- 1. Define a tabela
WHERE LAT_N < 137.2345;          -- 2. Filtra os dados
```

O SQL executa na seguinte ordem:

1. **FROM**: Seleciona a tabela
2. **WHERE**: Filtra as linhas
3. **SELECT**: Aplica fun√ß√µes e retorna resultado

## üõ†Ô∏è Como Testar

### No MySQL:

```sql
-- Criar a tabela
CREATE TABLE STATION (
    ID INT PRIMARY KEY,
    CITY VARCHAR(21),
    STATE VARCHAR(2),
    LAT_N DECIMAL(10, 6),
    LONG_W DECIMAL(10, 6)
);

-- Inserir dados de exemplo
INSERT INTO STATION VALUES
(1, 'Portland', 'ME', 43.661400, 70.255300),
(2, 'Nashville', 'TN', 36.144600, 86.748900),
(3, 'Phoenix', 'AZ', 137.229900, 112.074000),
(4, 'Boston', 'MA', 42.360100, 71.058900),
(5, 'Tokyo', 'JP', 138.772500, 139.691700),
(6, 'Miami', 'FL', 137.234400, 80.191800),
(7, 'Seattle', 'WA', 47.606200, 122.332100);

-- Executar a consulta
SELECT TRUNCATE(MAX(LAT_N), 4) AS max_lat_n
FROM STATION
WHERE LAT_N < 137.2345;
```

### No PostgreSQL:

```sql
-- Criar a tabela
CREATE TABLE STATION (
    ID INT PRIMARY KEY,
    CITY VARCHAR(21),
    STATE VARCHAR(2),
    LAT_N DECIMAL(10, 6),
    LONG_W DECIMAL(10, 6)
);

-- Inserir dados de exemplo
INSERT INTO STATION VALUES
(1, 'Portland', 'ME', 43.661400, 70.255300),
(2, 'Nashville', 'TN', 36.144600, 86.748900),
(3, 'Phoenix', 'AZ', 137.229900, 112.074000),
(4, 'Boston', 'MA', 42.360100, 71.058900),
(5, 'Tokyo', 'JP', 138.772500, 139.691700),
(6, 'Miami', 'FL', 137.234400, 80.191800),
(7, 'Seattle', 'WA', 47.606200, 122.332100);

-- Executar a consulta
SELECT TRUNC(MAX(LAT_N)::numeric, 4) AS max_lat_n
FROM STATION
WHERE LAT_N < 137.2345;
```

## üí° Varia√ß√µes do Problema

### 1. Encontrar o MENOR valor (MIN)

```sql
-- MySQL
SELECT TRUNCATE(MIN(LAT_N), 4)
FROM STATION
WHERE LAT_N < 137.2345;

-- PostgreSQL
SELECT TRUNC(MIN(LAT_N)::numeric, 4)
FROM STATION
WHERE LAT_N < 137.2345;
```

### 2. Calcular a M√âDIA (AVG)

```sql
-- MySQL
SELECT TRUNCATE(AVG(LAT_N), 4)
FROM STATION
WHERE LAT_N < 137.2345;

-- PostgreSQL
SELECT TRUNC(AVG(LAT_N)::numeric, 4)
FROM STATION
WHERE LAT_N < 137.2345;
```

### 3. Usar ROUND ao inv√©s de TRUNCATE

```sql
-- MySQL
SELECT ROUND(MAX(LAT_N), 4)
FROM STATION
WHERE LAT_N < 137.2345;

-- PostgreSQL
SELECT ROUND(MAX(LAT_N)::numeric, 4)
FROM STATION
WHERE LAT_N < 137.2345;
```

## üéì Dicas para Iniciantes

1. **Fun√ß√µes de agrega√ß√£o sempre retornam um √∫nico valor**, n√£o m√∫ltiplas linhas
2. **WHERE sempre vem antes de MAX/MIN/AVG**, pois primeiro filtramos, depois agregamos
3. **TRUNCATE corta, ROUND arredonda** - escolha conforme o requisito
4. **No PostgreSQL, use ::numeric** para converter tipos quando necess√°rio
5. **Teste com dados simples** antes de aplicar em grandes tabelas

## üîÑ Compara√ß√£o MySQL vs PostgreSQL

| Aspecto             | MySQL                    | PostgreSQL             |
| ------------------- | ------------------------ | ---------------------- |
| Fun√ß√£o de truncar   | `TRUNCATE(valor, casas)` | `TRUNC(valor, casas)`  |
| Convers√£o de tipo   | Autom√°tica               | Precisa de `::numeric` |
| Sintaxe MAX/MIN/AVG | Id√™ntica                 | Id√™ntica               |

## ‚ùå Erros Comuns

### 1. Esquecer o WHERE

```sql
-- ‚ùå ERRADO - retorna o maior de TODAS as latitudes
SELECT TRUNCATE(MAX(LAT_N), 4)
FROM STATION;

-- ‚úÖ CORRETO - retorna o maior das latitudes < 137.2345
SELECT TRUNCATE(MAX(LAT_N), 4)
FROM STATION
WHERE LAT_N < 137.2345;
```

### 2. Usar >= ao inv√©s de <

```sql
-- ‚ùå ERRADO - inclui 137.2345
WHERE LAT_N <= 137.2345

-- ‚úÖ CORRETO - exclui 137.2345
WHERE LAT_N < 137.2345
```

### 3. Confundir TRUNCATE com ROUND

```sql
-- Se LAT_N = 137.2344999

TRUNCATE(LAT_N, 4) ‚Üí 137.2344 ‚úì (correto)
ROUND(LAT_N, 4)    ‚Üí 137.2345 ‚úó (errado para este exerc√≠cio)
```

## üéØ Pr√≥ximos Passos

Ap√≥s dominar este exerc√≠cio, pratique:

- Combinar m√∫ltiplas fun√ß√µes de agrega√ß√£o: `SELECT MAX(LAT_N), MIN(LAT_N), AVG(LAT_N)`
- Usar `GROUP BY` com agrega√ß√µes
- Trabalhar com `HAVING` para filtrar resultados agregados
- Explorar outras fun√ß√µes matem√°ticas: `CEIL()`, `FLOOR()`, `ABS()`

## üìñ Refer√™ncias

- [MySQL TRUNCATE Documentation](https://dev.mysql.com/doc/refman/8.0/en/mathematical-functions.html#function_truncate)
- [PostgreSQL TRUNC Documentation](https://www.postgresql.org/docs/current/functions-math.html)
- [SQL Aggregate Functions](https://www.w3schools.com/sql/sql_count_avg_sum.asp)
- [HackerRank SQL Practice](https://www.hackerrank.com/domains/sql)

---

**Dificuldade:** F√°cil üü¢  
**T√≥picos:** Aggregation, MAX, TRUNCATE, WHERE  
**Tempo estimado:** 5-10 minutos  
**Categoria:** Weather Observation Station Series
